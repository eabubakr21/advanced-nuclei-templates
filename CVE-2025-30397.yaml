id: cve-2025-30397-detection

info:
  name: CVE-2025-30397 - JScript RCE - Malicious Web Content Detection
  author: Eslam Abu Bakr @eabubakr21
  severity: high
  description: |
    Detects the presence of publicly known exploit code for the CVE-2025-30397 JScript RCE
    vulnerability in web content. This template flags servers hosting malicious scripts
    designed to achieve RCE on a visitor's machine.
  reference:
    - https://msrc.microsoft.com/advisory/CVE-2025-30397
  tags: cve,cve2025,jscript,rce,client-side,detection,malicious

# This template is self-contained and does not require external variables.
self-contained: true

# Stop scanning other paths on this host once a match is found.
stop-at-first-match: true

requests:
  - method: GET
    # Fuzz common paths where exploit files might be located.
    path:
      - "{{BaseURL}}/{{path}}"
      - "{{BaseURL}}/js/{{path}}"
      - "{{BaseURL}}/assets/{{path}}"

    # Define a list of common file names to check.
    payloads:
      path:
        - "index.html"
        - "main.html"
        - "login.html"
        - "exploit.html"
        - "poc.html"
        - "payload.js"
        - "main.js"
        - "app.js"

    # The 'attack' directive is not needed with a single payload set.
    # Nuclei will automatically iterate through the 'path' payloads.

    # The matchers-condition applies to all matchers in this block.
    # Both conditions (status and words) must be met.
    matchers-condition: and

    matchers:
      # Matcher 1: Ensure we got a successful response (200 OK).
      - type: status
        status:
          - 200

      # Matcher 2: Check the response body for known exploit signatures.
      # Finding ANY of these words is sufficient to raise an alert.
      - type: word
        part: body
        words:
          - "new ActiveXObject(\"WScript.Shell\")"
          - "valueOf();toString();"
          - "for(var i=0;i<30;i++){"
        condition: or
