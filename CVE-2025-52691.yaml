id: CVE-2025-52691

info:
  name: SmarterMail - Arbitrary File Upload (RCE)
  author: rxerium
  severity: critical
  description: |
    SmarterMail Build earlier than 9413 is vulnerable to arbitrary file upload. An unauthenticated attacker can upload arbitrary files to any location on the mail server, potentially enabling remote code execution.
  remediation: Update to SmarterMail Build 9413 or later.
  reference:
    - https://www.csa.gov.sg/alerts-and-advisories/alerts/al-2025-124
    - https://www.smartertools.com/smartermail
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cve-id: CVE-2025-52691
    cwe-id: CWE-434
  metadata:
    verified: true
    max-request: 1
    vendor: smartertools
    product: smartermail
    shodan-query: http.favicon.hash:-1935525788
  tags: cve,cve2025,smartermail,rce,file-upload,critical

http:
  - method: GET
    path:
      - "{{BaseURL}}/interface/root#/login"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'ng-app="smartermail"'

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - compare_versions(build, '<= 9406')

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "stProductVersion\\s*=\\s*['\"]([0-9]+\\.[0-9]+\\.[0-9]+)['\"]"

      - type: regex
        name: build
        internal: true
        part: body
        group: 1
        regex:
          - "stProductVersion\\s*=\\s*['\"][0-9]+\\.[0-9]+\\.([0-9]+)['\"]"

      - type: dsl
        dsl:
          - '"Version: " + version + " (Build: " + build + ")"'
